<!-- alertas -->
<p-toast />

<div class="flex justify-end mb-2">
	<p-button
		(onClick)="toggleDialog()"
		label="create"
		styleClass="bg-zinc-100 rounded px-4 py-2"
	/>
</div>

<p-table [value]="loans" styleClass="text-sm">
	<ng-template pTemplate="header">
		<tr>
			<th>Book</th>
			<th>User</th>
			<th>User email</th>
			<th>LoanDate</th>
			<th>ReturnDate</th>
			<th>Returned</th>
			<th>Actions</th>
		</tr>
	</ng-template>
	<ng-template pTemplate="body" let-loan>
		<tr>
			<td>{{ loan.libro.titulo }}</td>
			<td>{{ loan.usuario.name }}</td>
			<td>{{ loan.usuario.email }}</td>
			<td>{{ loan.fechaPrestamo | date }}</td>
			<td>{{ loan.fechaDevolucion | date }}</td>
			<td>{{ loan.entregado? true : false }}</td>
			<td class="flex gap-2">
				<p-confirmPopup />
				<p-button
					(onClick)="setLoanSelected(loan)"
					label="edit"
					styleClass="bg-zinc-100 rounded px-4 py-2"
				/>
				<p-button
					(click)="confirmDelete($event, loan.id)"
					label="delete"
					styleClass="bg-zinc-200 rounded px-4 py-2"
				/>
			</td>
		</tr>
	</ng-template>
</p-table>

<p-dialog
	[header]="'Create a new loan'"
	draggable="false"
	[modal]="true"
	[(visible)]="visible"
	[style]="{ width: '25rem' }"
>
	<span class="p-text-secondary block mb-5">{{'Create a new loan'}}</span>

	<ng-container *ngIf="visible">
		<app-form
			[loanSelected]="loanSelected"
			(toggleDialog)="toggleDialog()"
			(loadLoans)="loadLoans()"
			(showToast)="showToast($event)"
		></app-form>
	</ng-container>
</p-dialog>
